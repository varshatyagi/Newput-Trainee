<!Doctype html>

<head>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-1.11.3.js"></script>
    <title>Demo Page</title>
    <script>
      $(document).ready(function(){
        $( ".lightbulb" ).on( "light:toggle", function( event ) {
          var light = $( this );
          if ( light.is( ".on" ) ) {
            light.trigger( "light:off" );
          } else {
              light.trigger( "light:on" );
          }
        }).on( "light:on", function( event ) {
          $( this ).removeClass( "off" ).addClass( "on" );
        }).on( "light:off", function( event ) {
          $( this ).removeClass( "on" ).addClass( "off" );
        });

        $( ".switch, .clapper" ).click(function() {
          var room = $( this ).closest( ".room" );
          room.find( ".lightbulb" ).trigger( "light:toggle" );
        });
       
        $( "#master_switch" ).click(function() {
          var lightbulbs = $( ".lightbulb" );
          if ( lightbulbs.is( ".on" ) ) {
            lightbulbs.trigger( "light:off" );
          } else {
            lightbulbs.trigger( "light:on" );
          }
        });
      })
    </script>  
</head>
<body>
  <div class="room" id="kitchen">
    <div class="lightbulb on">lightbulb</div>
    <div class="switch">switch</div>
    <div class="switch">switch</div>
    <div class="clapper">clapper</div>
  </div>
  <div class="room" id="bedroom">
    <div class="lightbulb on">lightbulb</div>
    <div class="switch">switch</div>
    <div class="switch">switch</div>
    <div class="clapper">clapper</div>
  </div>
  <div id="master_switch">master_switch</div>
</body>
</html>
